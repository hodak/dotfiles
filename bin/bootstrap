#!/usr/bin/env bash
source ~/dotfiles/zsh/functions.zsh

set -e

# Ask for sudo access
sudo -v

DEFAULT_SHELL=`which zsh`
HOST_NAME="obla-di-bla-da"

# sudo apt install zsh
# echo "Changing default shell to $DEFAULT_SHELL..."
# sudo chsh -s "$DEFAULT_SHELL" "$USER"

# sudo apt update
# sudo apt upgrade
sudo apt install build-essential libssl-dev rbenv ruby-build imagemagick memcached \
  python-dev python3-dev postgresql tmux cmake vim redis-server silversearcher-ag mysql-server

# This command can't be run twice
# git clone https://github.com/rbenv/rbenv-vars.git $(rbenv root)/plugins/rbenv-vars

## setup ruby
RUBY_VERSION="2.2.3"
if !(rbenv versions | grep $RUBY_VERSION > /dev/null); then
  echo "Installing: ruby $RUBY_VERSION"
  rbenv install $RUBY_VERSION
fi
rbenv global $RUBY_VERSION

# echo "Configuring Bundler for faster, parallel gem installation ..."
# number_of_cores=`sysctl -n hw.ncpu`
# bundle config --global jobs `expr $number_of_cores - 1`

# Set up vim Plug
curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

exit 0
